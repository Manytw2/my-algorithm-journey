#include "utility.h"
#include <vector>
#include <iostream>

using namespace std;
using namespace algo;
int Partition1(vector<int> & R, int s, int t) {
    int i = s, j = t;
    int base = R[s];

    while (i < j) {
        // ä»Žå³å‘å·¦æ‰¾å°äºŽåŸºå‡†çš„å…ƒç´ 
        while (i < j && R[j] >= base) {
            j--;
        }
        if (i < j) {
            // jå äº†içš„ä½ç½®ï¼Œiå¾€åŽèµ°ï¼ŒjåŽŸæœ¬ä½ç½®å˜ä¸ºbase (å‘)
            R[i] = R[j];
            i++;
        }

        // ä»Žå·¦å‘å³æ‰¾å¤§äºŽåŸºå‡†çš„å…ƒç´ 
        while (i < j && R[i] <= base) {
            i++;
        }
        if (i < j) {
            // iå äº†jçš„ä½ç½®ï¼Œjå¾€å‰èµ°ï¼ŒiåŽŸæœ¬ä½ç½®å˜ä¸ºbase (å‘)
            R[j] = R[i];
            j--;
        }
    }

    // åŸºå‡†å½’ä½ (å¡«å‘)
    R[i] = base;
    return i;
}

int main() {
    printAlgorithmTitle("å¿«é€ŸæŽ’åº-Partition1ï¼ˆæŒ–å‘å¡«æ•°æ³•ï¼‰");

    // æµ‹è¯•æ•°æ®
    vector<int> arr = {5, 3, 1, 9, 2, 8, 4, 7, 6};

    cout << "ðŸ“Š åŽŸå§‹æ•°ç»„: ";
    array_utils::print(arr, "", 20);

    int low = 0;
    int high = arr.size() - 1;

    // æ€§èƒ½æµ‹è¯•
    AlgorithmTester tester("Partition1");
    int pivot_index = 0;

    tester.testPerformance([&]() {
        pivot_index = Partition1(arr, low, high);
    }, arr.size());

    cout << "\nðŸ“ åŸºå‡†ä½ç½®: " << pivot_index << endl;
    cout << "ðŸ“ åŸºå‡†å€¼: " << arr[pivot_index] << endl;
    cout << "ðŸ“Š PartitionåŽæ•°ç»„: ";
    array_utils::print(arr, "", 20);

    // éªŒè¯Partitionç»“æžœ
    bool valid = true;
    for (int i = 0; i < pivot_index; i++) {
        if (arr[i] > arr[pivot_index]) {
            valid = false;
            break;
        }
    }
    for (size_t i = pivot_index + 1; i < arr.size(); i++) {
        if (arr[i] < arr[pivot_index]) {
            valid = false;
            break;
        }
    }

    cout << "\nðŸ” PartitionéªŒè¯: " << (valid ? "âœ… æ­£ç¡®" : "âŒ é”™è¯¯") << endl;

    cout << "\nðŸ“š ç®—æ³•ç‰¹æ€§:" << endl;
    cout << "   â€¢ æ–¹æ³•: æŒ–å‘å¡«æ•°æ³•" << endl;
    cout << "   â€¢ æ—¶é—´å¤æ‚åº¦: O(n)" << endl;
    cout << "   â€¢ ç©ºé—´å¤æ‚åº¦: O(1)" << endl;
    cout << "   â€¢ ç‰¹ç‚¹: å‡å°‘äº¤æ¢æ¬¡æ•°ï¼Œæ•ˆçŽ‡è¾ƒé«˜" << endl;

    return 0;
}

/*
 * ðŸ“ ç®—æ³•æ€»ç»“ - æŒ–å‘å¡«æ•°æ³•
 *
 * è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å°±åƒæ˜¯åœ¨åœ°ä¸ŠæŒ–å‘å¡«å‘ä¸€æ · (â—•â€¿â—•)
 * æƒ³è±¡ä¸€ä¸‹ï¼Œä½ è¦æŠŠä¸€å †æ•°å­—æŒ‰å¤§å°åˆ†å¼€ï¼ŒåŸºå‡†å€¼å°±æ˜¯è¿™ä¸ª"å‘"
 *
 * ðŸŽ¯ ç®—æ³•æ€è·¯ï¼š
 * 1. å…ˆæŠŠåŸºå‡†å€¼ R[s] æŒ–å‡ºæ¥å½“å‘ (base)
 * 2. ä»Žå³è¾¹ j å¼€å§‹ï¼Œæ‰¾åˆ°æ¯”åŸºå‡†å°çš„æ•°å­—ï¼Œå¡«åˆ°å·¦è¾¹çš„å‘é‡Œ
 *    å¡«å®ŒåŽï¼ŒåŽŸæ¥ j çš„ä½ç½®å˜æˆäº†æ–°çš„å‘ (â—”_â—”)
 * 3. ä»Žå·¦è¾¹ i å¼€å§‹ï¼Œæ‰¾åˆ°æ¯”åŸºå‡†å¤§çš„æ•°å­—ï¼Œå¡«åˆ°å³è¾¹çš„å‘é‡Œ
 *    å¡«å®ŒåŽï¼ŒåŽŸæ¥ i çš„ä½ç½®åˆå˜æˆäº†æ–°çš„å‘
 * 4. é‡å¤æ­¥éª¤ 2 å’Œ 3ï¼Œç›´åˆ° i å’Œ j ç›¸é‡
 * 5. æœ€åŽæŠŠåŸºå‡†å€¼å¡«å›žæœ€åŽçš„å‘é‡Œ (ãƒŽâ—•Ï‰â—•)ãƒŽ
 *
 * è¿™æ ·å°±å®Œæˆäº†åˆ†ç»„ï¼šåŸºå‡†å·¦è¾¹éƒ½æ˜¯å°çš„ï¼Œå³è¾¹éƒ½æ˜¯å¤§çš„ï¼
 *
 * â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) - åªéœ€è¦éåŽ†ä¸€æ¬¡æ•°ç»„
 * ðŸ’¾ ç©ºé—´å¤æ‚åº¦ï¼šO(1) - åªç”¨äº†å‡ ä¸ªå˜é‡ï¼ŒåŽŸåœ°æŽ’åº
 *
 * ðŸŒŸ ä¼˜ç‚¹ï¼š
 * - å‡å°‘äº†æ•°å­—äº¤æ¢çš„æ¬¡æ•°ï¼Œæ›´é«˜æ•ˆ (ï¾‰â—•ãƒ®â—•)ï¾‰
 * - é€»è¾‘æ¸…æ™°ï¼Œç†è§£èµ·æ¥ä¹Ÿä¸éš¾
 *
 * è¿™å°±æ˜¯å¿«é€ŸæŽ’åºä¸­æœ€å¸¸ç”¨çš„åˆ’åˆ†æ–¹æ³•ä¹‹ä¸€ï¼(=â€¿=)
 */
